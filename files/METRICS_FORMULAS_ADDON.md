# –î–û–ü–û–õ–ù–ï–ù–ò–ï: –ù–∏–∂–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ —à–∫–∞–ª–∞ —É—Ä–æ–≤–Ω–µ–π

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê: –£—Ä–æ–≤–µ–Ω—å 5a-5b —Å–ª–∏—à–∫–æ–º –∑–∞–Ω–∏–∂–µ–Ω

–ü—Ä–∏ –±–∞–ª–ª–µ 54 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "5a-5b" ‚Äî —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∫–∞–ª–æ–ª–∞–∑–æ–≤ –ª–∞–∑–∞—é—Ç 6a+.

### –°—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø):
```
90+ ‚Üí 7b+
85-89 ‚Üí 7a-7b
80-84 ‚Üí 6c-7a
75-79 ‚Üí 6b-6c
70-74 ‚Üí 6a-6b
65-69 ‚Üí 5c-6a
60-64 ‚Üí 5b-5c
50-59 ‚Üí 5a-5b    ‚Üê 54 –±–∞–ª–ª–∞ –ø–æ–ø–∞–¥–∞–µ—Ç —Å—é–¥–∞
0-49 ‚Üí –¥–æ 5a
```

### –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–ü–†–ê–í–ò–õ–¨–ù–ê–Ø):
```python
GRADE_TABLE = [
    (85, "7b+"),
    (80, "7a‚Äî7b"),
    (75, "6c‚Äî7a"),
    (68, "6b‚Äî6c"),
    (60, "6a‚Äî6b"),    # ‚Üê 54 –±–∞–ª–ª–∞ –±—É–¥–µ—Ç –Ω–∏–∂–µ
    (50, "5c‚Äî6a"),    # ‚Üê 54 –±–∞–ª–ª–∞ –ø–æ–ø–∞–¥–∞–µ—Ç —Å—é–¥–∞
    (40, "5b‚Äî5c"),
    (30, "5a‚Äî5b"),
    (0, "–¥–æ 5a")
]

def estimate_grade(overall_score):
    for threshold, grade in GRADE_TABLE:
        if overall_score >= threshold:
            return grade
    return "–¥–æ 5a"
```

**–ü—Ä–∏ 54 –±–∞–ª–ª–∞—Ö ‚Üí "5c‚Äî6a"** ‚Äî –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ.

---

## üìä –§–û–†–ú–£–õ–´ –ù–ò–ñ–ù–ò–• –ú–ï–¢–†–ò–ö

### 1. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (Stability) ‚úÖ —É–∂–µ –µ—Å—Ç—å

```python
def calculate_stability(center_of_mass_history, window=30):
    """
    –î–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞ –º–∞—Å—Å.
    –ù–∏–∑–∫–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è = –≤—ã—Å–æ–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.
    """
    if len(center_of_mass_history) < window:
        return 50  # –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö
    
    variances = []
    for i in range(len(center_of_mass_history) - window):
        segment = center_of_mass_history[i:i+window]
        x_var = variance([p.x for p in segment])
        y_var = variance([p.y for p in segment])
        variances.append(x_var + y_var)
    
    avg_variance = mean(variances)
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: variance < 5 = –æ—Ç–ª–∏—á–Ω–æ, > 50 = –ø–ª–æ—Ö–æ
    score = max(0, 100 - avg_variance * 2)
    return max(10, min(100, score))
```

---

### 2. –ò—Å—Ç–æ—â–µ–Ω–∏–µ (Exhaustion) ‚úÖ —É–∂–µ –µ—Å—Ç—å

```python
def calculate_exhaustion(metrics_timeline):
    """
    –ü–∞–¥–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–≤–∏–∂–µ–Ω–∏–π –æ—Ç –Ω–∞—á–∞–ª–∞ –∫ –∫–æ–Ω—Ü—É.
    –í—ã—Å–æ–∫–∏–π % = —Å–∏–ª—å–Ω–æ–µ –∏—Å—Ç–æ—â–µ–Ω–∏–µ.
    """
    if len(metrics_timeline) < 20:
        return 20  # –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö
    
    # –î–µ–ª–∏–º –Ω–∞ 4 —á–∞—Å—Ç–∏
    quarter_len = len(metrics_timeline) // 4
    
    q1 = metrics_timeline[:quarter_len]           # –ø–µ—Ä–≤–∞—è —á–µ—Ç–≤–µ—Ä—Ç—å
    q4 = metrics_timeline[-quarter_len:]          # –ø–æ—Å–ª–µ–¥–Ω—è—è —á–µ—Ç–≤–µ—Ä—Ç—å
    
    q1_quality = mean([m.get('quality', 50) for m in q1])
    q4_quality = mean([m.get('quality', 50) for m in q4])
    
    if q1_quality == 0:
        return 20
    
    # –ü–∞–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    degradation = (q1_quality - q4_quality) / q1_quality * 100
    
    return max(5, min(100, degradation))
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- < 20%: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å—Ç–æ—â–µ–Ω–∏–µ, —Ä–µ–∑–µ—Ä–≤ —Å–∏–ª
- 20-40%: —É–º–µ—Ä–µ–Ω–Ω–æ–µ, –Ω–æ—Ä–º–∞ –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
- 40-60%: –∑–∞–º–µ—Ç–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ
- > 60%: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Ç–æ—â–µ–Ω–∏–µ

---

### 3. –†—É–∫–∏ ‚Äî % –Ω–∞–≥—Ä—É–∑–∫–∏ ‚úÖ —É–∂–µ –µ—Å—Ç—å

```python
def calculate_arm_load_percentage(weight_distribution_history):
    """
    –ö–∞–∫–æ–π % –≤–µ—Å–∞ –Ω–µ—Å—É—Ç —Ä—É–∫–∏.
    –ù–æ—Ä–º–∞: 30-40%. –ë–æ–ª—å—à–µ = –ø–µ—Ä–µ–≥—Ä—É–∑.
    """
    arm_loads = []
    
    for frame in weight_distribution_history:
        total = frame.left_arm + frame.right_arm + frame.left_leg + frame.right_leg
        if total > 0:
            arm_pct = (frame.left_arm + frame.right_arm) / total * 100
            arm_loads.append(arm_pct)
    
    if len(arm_loads) == 0:
        return 40  # default
    
    return mean(arm_loads)
```

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∞–º –ø—Ä–æ—Ü–µ–Ω—Ç (35%, 69% –∏ —Ç.–¥.)
- 30-40%: ‚úÖ –Ω–æ—Ä–º–∞ (–∑–µ–ª—ë–Ω—ã–π)
- 40-50%: ‚ö†Ô∏è –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è (–∂—ë–ª—Ç—ã–π)
- > 50%: üî¥ –ø–µ—Ä–µ–≥—Ä—É–∑ (–∫—Ä–∞—Å–Ω—ã–π)

---

### 4. –ù–æ–≥–∏ ‚Äî % –Ω–∞–≥—Ä—É–∑–∫–∏ ‚úÖ —É–∂–µ –µ—Å—Ç—å

```python
def calculate_leg_load_percentage(weight_distribution_history):
    """
    –ö–∞–∫–æ–π % –≤–µ—Å–∞ –Ω–µ—Å—É—Ç –Ω–æ–≥–∏.
    –ù–æ—Ä–º–∞: 60-70%. –ú–µ–Ω—å—à–µ = –Ω–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.
    """
    leg_loads = []
    
    for frame in weight_distribution_history:
        total = frame.left_arm + frame.right_arm + frame.left_leg + frame.right_leg
        if total > 0:
            leg_pct = (frame.left_leg + frame.right_leg) / total * 100
            leg_loads.append(leg_pct)
    
    if len(leg_loads) == 0:
        return 60  # default
    
    return mean(leg_loads)
```

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∞–º –ø—Ä–æ—Ü–µ–Ω—Ç
- 60-70%: ‚úÖ –Ω–æ—Ä–º–∞ (–∑–µ–ª—ë–Ω—ã–π)
- 50-60%: ‚ö†Ô∏è –Ω–µ–¥–æ–≥—Ä—É–∑ (–∂—ë–ª—Ç—ã–π)
- < 50%: üî¥ –Ω–æ–≥–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (–∫—Ä–∞—Å–Ω—ã–π)

---

### 5. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (Recovery) ‚úÖ —É–∂–µ –µ—Å—Ç—å

```python
def calculate_recovery(rest_positions, tension_data):
    """
    –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–¥—ã—Ö–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ.
    """
    if len(rest_positions) == 0:
        return 40  # –Ω–µ—Ç –ø–∞—É–∑ ‚Äî —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª
    
    scores = []
    
    for rest in rest_positions:
        # –ù–∞—Å–∫–æ–ª—å–∫–æ —Ä–∞—Å—Å–ª–∞–±–∏–ª–∏—Å—å –≤ –ø–∞—É–∑–µ
        tension_drop = rest.tension_before - rest.tension_during
        
        # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (2-5 —Å–µ–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
        if 2 <= rest.duration <= 5:
            duration_score = 100
        elif rest.duration < 2:
            duration_score = rest.duration / 2 * 100
        else:
            duration_score = max(60, 100 - (rest.duration - 5) * 5)
        
        # –í—ã–ø—Ä—è–º–ª–µ–Ω—ã –ª–∏ —Ä—É–∫–∏
        arm_score = 100 if rest.avg_arm_angle > 150 else 50
        
        total = (tension_drop * 2 + duration_score + arm_score) / 4
        scores.append(total)
    
    return max(10, min(100, mean(scores)))
```

---

### 6. –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (Productivity) üÜï –ù–û–í–ê–Ø

```python
def calculate_productivity(progress_data, energy_spent):
    """
    –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–¥–≤–∏–Ω—É–ª–∏—Å—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏.
    
    progress_data: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∑–∞ –º–∞—Ä—à—Ä—É—Ç (–≤ –º–µ—Ç—Ä–∞—Ö –∏–ª–∏ % —Å—Ç–µ–Ω—ã)
    energy_spent: —Å—É–º–º–∞—Ä–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ √ó –≤—Ä–µ–º—è
    """
    if energy_spent == 0:
        return 50
    
    # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
    vertical_progress = progress_data.get('total_climb_height', 0)  # –º–µ—Ç—Ä—ã
    expected_progress = progress_data.get('route_height', 4)  # –º–µ—Ç—Ä—ã
    
    progress_ratio = vertical_progress / expected_progress if expected_progress > 0 else 0
    
    # –≠–Ω–µ—Ä–≥–æ–∑–∞—Ç—Ä–∞—Ç—ã (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ)
    # energy_spent = —Å—É–º–º–∞ tension * time –¥–ª—è –≤—Å–µ—Ö –∫–∞–¥—Ä–æ–≤
    expected_energy = expected_progress * 1000  # –ø—Ä–∏–º–µ—Ä–Ω–∞—è –Ω–æ—Ä–º–∞
    
    energy_ratio = energy_spent / expected_energy if expected_energy > 0 else 1
    
    # –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å = –ø—Ä–æ–≥—Ä–µ—Å—Å / —ç–Ω–µ—Ä–≥–∏—è
    if energy_ratio == 0:
        return 50
    
    productivity = progress_ratio / energy_ratio * 100
    
    return max(10, min(100, productivity))
```

**–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–±–µ–∑ —Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –≤—ã—Å–æ—Ç–µ):**

```python
def calculate_productivity_simple(movement_data, tension_data):
    """
    –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –ø–æ–ª–µ–∑–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ / –æ–±—â–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ.
    """
    # –ü–æ–ª–µ–∑–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ = –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö
    useful_movement = sum([
        m.vertical_delta for m in movement_data 
        if m.vertical_delta > 0  # —Ç–æ–ª—å–∫–æ –≤–≤–µ—Ä—Ö
    ])
    
    # –û–±—â–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ = –≤—Å–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
    total_movement = sum([
        abs(m.vertical_delta) + abs(m.horizontal_delta) 
        for m in movement_data
    ])
    
    if total_movement == 0:
        return 50
    
    # –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è
    avg_tension = mean([t.value for t in tension_data]) if tension_data else 50
    
    # –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å = (–ø–æ–ª–µ–∑–Ω–æ–µ / –æ–±—â–µ–µ) √ó (100 - –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ) / 50
    base_productivity = useful_movement / total_movement * 100
    tension_factor = (100 - avg_tension) / 50  # –æ—Ç 0 –¥–æ 2
    
    score = base_productivity * tension_factor
    
    return max(10, min(100, score))
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- > 70%: –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –º–∞–ª–æ –ª–∏—à–Ω–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–π
- 50-70%: –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è
- 30-50%: –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –Ω–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- < 30%: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∞—è

---

### 7. –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å (Economy) üÜï –ù–û–í–ê–Ø

```python
def calculate_economy(movement_data, hold_count):
    """
    –ú–∏–Ω–∏–º—É–º –ª–∏—à–Ω–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–π.
    
    –ò–¥–µ–∞–ª: 1 –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–∞ 1 –ø–µ—Ä–µ—Ö–≤–∞—Ç.
    –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏, —Ä–∞—Å–∫–∞—á–∏–≤–∞–Ω–∏—è.
    """
    if hold_count == 0:
        return 50
    
    # –°—á–∏—Ç–∞–µ–º –≤—Å–µ –¥–≤–∏–∂–µ–Ω–∏—è
    total_movements = len([m for m in movement_data if m.magnitude > threshold])
    
    # –ò–¥–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ü–µ–ø–æ–∫ √ó 2 (—Ä—É–∫–∞ + –Ω–æ–≥–∞)
    ideal_movements = hold_count * 2
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏—à–Ω–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–π
    if ideal_movements == 0:
        return 50
    
    movement_ratio = total_movements / ideal_movements
    
    # 1.0 = –∏–¥–µ–∞–ª, 2.0 = –≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –¥–≤–∏–∂–µ–Ω–∏–π —á–µ–º –Ω—É–∂–Ω–æ
    if movement_ratio <= 1.0:
        score = 100
    elif movement_ratio <= 1.5:
        score = 100 - (movement_ratio - 1.0) * 60  # 100 ‚Üí 70
    elif movement_ratio <= 2.0:
        score = 70 - (movement_ratio - 1.5) * 40   # 70 ‚Üí 50
    else:
        score = max(10, 50 - (movement_ratio - 2.0) * 20)
    
    return score
```

**–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:**

```python
def calculate_economy_simple(quiet_feet_score, grip_release_score, stability_score):
    """
    –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å –∫–∞–∫ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥—Ä—É–≥–∏—Ö –º–µ—Ç—Ä–∏–∫.
    """
    # –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å = —Å—Ä–µ–¥–Ω–µ–µ –æ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–æ–≥, –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    score = (quiet_feet_score * 0.4 + grip_release_score * 0.3 + stability_score * 0.3)
    return max(10, min(100, score))
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- > 80%: –æ—á–µ–Ω—å —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ–µ –ª–∞–∑–∞–Ω–∏–µ
- 60-80%: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ
- 40-60%: –º–Ω–æ–≥–æ –ª–∏—à–Ω–∏—Ö –¥–≤–∏–∂–µ–Ω–∏–π
- < 40%: –Ω–µ—ç–∫–æ–Ω–æ–º–∏—á–Ω–æ–µ, —Å—É–µ—Ç–ª–∏–≤–æ–µ –ª–∞–∑–∞–Ω–∏–µ

---

### 8. –ë–∞–ª–∞–Ω—Å (Balance) üÜï –ù–û–í–ê–Ø

```python
def calculate_balance(center_of_mass, support_points):
    """
    –ü–æ–ª–æ–∂–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –º–∞—Å—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–æ—á–µ–∫ –æ–ø–æ—Ä—ã.
    
    –ò–¥–µ–∞–ª: —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–Ω–æ–≥–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ–ø–æ—Ä—ã.
    """
    balance_scores = []
    
    for frame_idx, (com, supports) in enumerate(zip(center_of_mass, support_points)):
        # –¢–æ—á–∫–∏ –æ–ø–æ—Ä—ã = –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ –Ω–∞ –∑–∞—Ü–µ–ø–∫–∞—Ö
        active_supports = [s for s in supports if s.is_on_hold]
        
        if len(active_supports) < 2:
            balance_scores.append(50)  # –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–µ–∫
            continue
        
        # –¶–µ–Ω—Ç—Ä –º–Ω–æ–≥–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ–ø–æ—Ä—ã
        support_center = Point(
            mean([s.x for s in active_supports]),
            mean([s.y for s in active_supports])
        )
        
        # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –º–∞—Å—Å –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –æ–ø–æ—Ä—ã
        distance = euclidean_distance(com, support_center)
        
        # –†–∞–¥–∏—É—Å –º–Ω–æ–≥–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ–ø–æ—Ä—ã
        support_radius = max([
            euclidean_distance(s, support_center) for s in active_supports
        ])
        
        if support_radius == 0:
            balance_scores.append(50)
            continue
        
        # –ë–∞–ª–∞–Ω—Å = –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å –≤–Ω—É—Ç—Ä–∏ –∑–æ–Ω—ã –æ–ø–æ—Ä—ã
        # distance / radius < 1 = –≤–Ω—É—Ç—Ä–∏, > 1 = —Å–Ω–∞—Ä—É–∂–∏
        ratio = distance / support_radius
        
        if ratio <= 0.5:
            score = 100  # –∏–¥–µ–∞–ª—å–Ω–æ –≤ —Ü–µ–Ω—Ç—Ä–µ
        elif ratio <= 1.0:
            score = 100 - (ratio - 0.5) * 60  # 100 ‚Üí 70
        else:
            score = max(10, 70 - (ratio - 1.0) * 40)  # 70 ‚Üí 30
        
        balance_scores.append(score)
    
    return mean(balance_scores) if balance_scores else 50
```

**–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:**

```python
def calculate_balance_simple(stability_score, hip_position_score, diagonal_score):
    """
    –ë–∞–ª–∞–Ω—Å –∫–∞–∫ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–∞–∑–∞ –∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏.
    """
    score = (stability_score * 0.4 + hip_position_score * 0.3 + diagonal_score * 0.3)
    return max(10, min(100, score))
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- > 80%: –æ—Ç–ª–∏—á–Ω—ã–π –±–∞–ª–∞–Ω—Å, —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å –≤—Å–µ–≥–¥–∞ –Ω–∞–¥ –æ–ø–æ—Ä–æ–π
- 60-80%: —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å
- 40-60%: —á–∞—Å—Ç—ã–µ –ø–æ—Ç–µ—Ä–∏ –±–∞–ª–∞–Ω—Å–∞
- < 40%: –ø–ª–æ—Ö–æ–π –±–∞–ª–∞–Ω—Å, –º–Ω–æ–≥–æ —Ä–∞—Å–∫–∞—á–∏–≤–∞–Ω–∏–π

---

## üìê –ö–û–ú–ü–ê–ö–¢–ù–´–ô –î–ò–ó–ê–ô–ù –î–ê–®–ë–û–†–î–ê

### –ü—Ä–æ–±–ª–µ–º–∞:
–¢–µ–∫—É—â–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ, –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è.

### –†–µ—à–µ–Ω–∏–µ:
–°–¥–µ–ª–∞—Ç—å –ø–æ–ª–æ—Å—É –º–µ—Ç—Ä–∏–∫ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ, –æ–ø–∏—Å–∞–Ω–∏—è –≤ 1 —Å—Ç—Ä–æ–∫—É.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  QF  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 50%   –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–≥    ‚îÇ
‚îÇ  HP  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 31%   –ü–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∑–∞ —É —Å—Ç–µ–Ω—ã     ‚îÇ
‚îÇ  DM  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 54%   –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è   ‚îÇ
‚îÇ  RR  ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 20%   –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞      ‚îÇ
‚îÇ  RT  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë 57%   –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ç–µ–º–ø–∞        ‚îÇ
‚îÇ  DC  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë 77%   –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Å–ª–µ –±—Ä–æ—Å–∫–æ–≤     ‚îÇ
‚îÇ  GR  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 93%   –ü–ª–∞–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥:**

```python
def draw_metrics_compact(ax, metrics):
    """
    –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫: –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ + –±–∞—Ä + % + –æ–ø–∏—Å–∞–Ω–∏–µ –≤ 1 —Å—Ç—Ä–æ–∫—É.
    """
    metrics_config = [
        ("QF", "quiet_feet", "–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–≥"),
        ("HP", "hip_position", "–ü–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∑–∞ —É —Å—Ç–µ–Ω—ã"),
        ("DM", "diagonal", "–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è"),
        ("RR", "route_reading", "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞"),
        ("RT", "rhythm", "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ç–µ–º–ø–∞"),
        ("DC", "dynamic_control", "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Å–ª–µ –±—Ä–æ—Å–∫–æ–≤"),
        ("GR", "grip_release", "–ü–ª–∞–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤"),
    ]
    
    y_start = 95
    y_step = 12  # –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ!
    
    for i, (abbr, key, desc) in enumerate(metrics_config):
        y = y_start - i * y_step
        score = metrics.get(key, {}).get('score', 50)
        color = get_color_for_score(score)
        
        # –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ (–∂–∏—Ä–Ω–∞—è, —Å–ª–µ–≤–∞)
        ax.text(2, y, abbr, fontsize=10, fontweight='bold', color='white')
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–∫–æ—Ä–æ—Ç–∫–∏–π)
        bar_x, bar_width, bar_height = 25, 120, 8
        ax.add_patch(Rectangle((bar_x, y-4), bar_width, bar_height, fc='#333'))
        ax.add_patch(Rectangle((bar_x, y-4), bar_width * score/100, bar_height, fc=color))
        
        # –ü—Ä–æ—Ü–µ–Ω—Ç
        ax.text(bar_x + bar_width + 5, y, f"{int(score)}%", 
                fontsize=9, fontweight='bold', color=color)
        
        # –û–ø–∏—Å–∞–Ω–∏–µ (1 —Å—Ç—Ä–æ–∫–∞, —Å–µ—Ä—ã–º)
        ax.text(bar_x + bar_width + 35, y, desc, 
                fontsize=8, color='#888888')
```

---

## üìä –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ ‚Äî 8 –º–µ—Ç—Ä–∏–∫ –≤ 2 —Ä—è–¥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  27%         8%          69%         80%                    ‚îÇ
‚îÇ  –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å  –ò—Å—Ç–æ—â–µ–Ω–∏–µ   –†—É–∫–∏        –ù–æ–≥–∏                 ‚îÇ
‚îÇ  –∫–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–ª–∞ –∫ —Ñ–∏–Ω–∏—à—É    (–Ω–æ—Ä–º–∞ 30-40%) (–Ω–æ—Ä–º–∞ 60-70%)   ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  46%         52%         48%         57%                    ‚îÇ
‚îÇ  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å –ë–∞–ª–∞–Ω—Å        ‚îÇ
‚îÇ  –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–¥—ã—Ö–∞ —ç—Ñ—Ñ–µ–∫—Ç/–∑–∞—Ç—Ä–∞—Ç—ã –º–∏–Ω. –¥–≤–∏–∂–µ–Ω–∏–π  —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–¥:**

```python
BOTTOM_METRICS = [
    # –†—è–¥ 1
    [
        {"key": "stability", "name": "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", "hint": "–∫–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–ª–∞"},
        {"key": "exhaustion", "name": "–ò—Å—Ç–æ—â–µ–Ω–∏–µ", "hint": "–∫ —Ñ–∏–Ω–∏—à—É"},
        {"key": "arm_load", "name": "–†—É–∫–∏", "hint": "(–Ω–æ—Ä–º–∞ 30-40%)"},
        {"key": "leg_load", "name": "–ù–æ–≥–∏", "hint": "(–Ω–æ—Ä–º–∞ 60-70%)"},
    ],
    # –†—è–¥ 2
    [
        {"key": "recovery", "name": "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ", "hint": "–∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–¥—ã—Ö–∞"},
        {"key": "productivity", "name": "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "hint": "—ç—Ñ—Ñ–µ–∫—Ç/–∑–∞—Ç—Ä–∞—Ç—ã"},
        {"key": "economy", "name": "–≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å", "hint": "–º–∏–Ω. –¥–≤–∏–∂–µ–Ω–∏–π"},
        {"key": "balance", "name": "–ë–∞–ª–∞–Ω—Å", "hint": "—Ü–µ–Ω—Ç—Ä –º–∞—Å—Å"},
    ]
]

def draw_bottom_metrics(ax, metrics):
    for row_idx, row in enumerate(BOTTOM_METRICS):
        y = 70 - row_idx * 50  # –¥–≤–∞ —Ä—è–¥–∞
        
        for col_idx, metric in enumerate(row):
            x = 50 + col_idx * 200  # 4 –∫–æ–ª–æ–Ω–∫–∏
            
            value = metrics.get(metric["key"], 0)
            color = get_color_for_score(value)
            
            # –ë–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ
            ax.text(x, y, f"{int(value)}%", fontsize=24, fontweight='bold',
                    color=color, ha='center')
            
            # –ù–∞–∑–≤–∞–Ω–∏–µ
            ax.text(x, y - 20, metric["name"], fontsize=10, 
                    color='white', ha='center')
            
            # –ü–æ–¥—Å–∫–∞–∑–∫–∞
            ax.text(x, y - 32, metric["hint"], fontsize=8,
                    color='#666666', ha='center')
```

---

## ‚úÖ –ò–¢–û–ì

### –ò—Å–ø—Ä–∞–≤–∏—Ç—å —à–∫–∞–ª—É —É—Ä–æ–≤–Ω–µ–π:
```python
GRADE_TABLE = [
    (85, "7b+"),
    (80, "7a‚Äî7b"),
    (75, "6c‚Äî7a"),
    (68, "6b‚Äî6c"),
    (60, "6a‚Äî6b"),
    (50, "5c‚Äî6a"),
    (40, "5b‚Äî5c"),
    (30, "5a‚Äî5b"),
    (0, "–¥–æ 5a")
]
```

### –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫:
- [ ] –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî `calculate_productivity()`
- [ ] –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å ‚Äî `calculate_economy()`
- [ ] –ë–∞–ª–∞–Ω—Å ‚Äî `calculate_balance()`

### –°–¥–µ–ª–∞—Ç—å –¥–∏–∑–∞–π–Ω –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ:
- [ ] –£–º–µ–Ω—å—à–∏—Ç—å `y_step` –¥–æ 12
- [ ] –û–ø–∏—Å–∞–Ω–∏–µ –≤ 1 —Å—Ç—Ä–æ–∫—É
- [ ] –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å –≤ 2 —Ä—è–¥–∞ –ø–æ 4 –º–µ—Ç—Ä–∏–∫–∏
